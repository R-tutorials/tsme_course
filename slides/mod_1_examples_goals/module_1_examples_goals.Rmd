---
title: 'Module 1: Time series for Ecologists and Climatologists: examples & goals'
author: "Doug McNeall, Met Office"
output:
  ioslides_presentation:
    transition: slower
    widescreen: yes
  beamer_presentation: default
---

## Learning outcomes

- Understand key timeseries concepts and features
- See example timeseries that we'll use on the course
- Understand the types of analysis that we want to do, and why


## What is a time series?

- A collection of data indexed by (strictly increasing) time
- Can be regular or irregular
- Usually one value per time

## A short history of time series

__“With one dimension marching along to the regular rhythm of seconds, minutes, hours, days, weeks, months, years, centuries, or millennia, the natural ordering of the time scale gives this design a strength and efficiency of interpretation found in no other graphic arrangement.”__

Edward R. Tufte
The Visual Display of Quantitative Information
p. 28

## The first time series example?

<center><img src="~/GitHub/tsme_course/slides/graphics/early_timeseries.jpg" width=60%/></center>

Tenth or eleventh century time series showing the position of the planets with time.
http://euclid.psych.yorku.ca/SCS/Gallery/milestone/sec2.html

## Skipping forward a bit ...

<center><img src="~/GitHub/tsme_course/slides/graphics/Cruquius-Diagram-eclipse-1732.jpg" width=50%/></center>

Diagram showing the distance of the planets to the earth in 1732, also showing a complete lunar eclipse and a partial solar eclipse in that year
Nicolaas Kruik 1678 - 1754 Dutch Astronomer & Meteorologist

## Lambert

<center><img src="~/GitHub/tsme_course/slides/graphics/lambert1779-graph.jpg" width=50%/></center>

A graph of solar warming vs. lattitude.  
Johann Heinrich Lambert 1728 - 1777

## Application to economic data

<center><img src="~/GitHub/tsme_course/slides/graphics/Playfair_TimeSeries-2.png" width=60%/></center>
Willaim Playfair's trade-balance time-series chart, published in his Commercial and Political Atlas, 1786

## Time Series Analysis: What's the point?

What do we use time series methods for? Often, we are trying to do at least one of the following:

1. Description: what is going on?
2. Understanding: how is it going on, and why?
3. Prediction: What is going to go on next?

## First, description
- HadCRUT4 Annual globally averaged surface temperature, from the Met Office Hadley Centre and Climate Research Unit, UEA.

- How do we separate the **structure** (here the long term trend) and the random **noise**?
```{r plot hadcrut straight, echo=FALSE}
hadcrut = read.csv('~/GitHub/tsme_course/data/hadcrut.csv')
with(hadcrut,plot(Year,Anomaly))
# Is there a trend? (this could just be a slice from a random process, right?)
# If yes, why is there a trend
# In that case, what will happen next year? How about in 2100?
```

## Plot the data
- Using a line plot gives a slightly different impression.
```{r plot hadcrut l, echo=FALSE}
hadcrut = read.csv('~/GitHub/tsme_course/data/hadcrut.csv')
with(hadcrut,plot(Year,Anomaly,type='l'))
# perhaps plot a smoothed version?
```

## What is going on?
We get a different impression again if we just plot the last 15 years ..  
(GWPF + hiatus)


## And make a prediction

Would we/could we have predicted the hiatus? How about the massive jump in temperature of the last year?

So, what *is* structure? And what is random?

## A simpler example? Sea level rise
- Church and White
- There appears relatively less noise in this data compared to the trend
```{r load sea level data, echo=FALSE}
candw = read.csv('~/GitHub/tsme_course/data/church_and_white_global_tide_gauge.csv')
with(candw,plot(year_AD,sea_level_m,type='l'))
```

## Changes in variability & Heteroskedasticity
- This AirPassengers data set shows **heteroskedasticity**
```{r plot AirPassengers, echo=FALSE}
plot(AirPassengers)
```

## Example - GISP2 stable isotope ratios in Greenland ice
- This data shows **heteroskedacity** and **regime changes** and a lot of **structure**
```{r load gisp2 data, echo=FALSE}
gisp2 = read.table('~/GitHub/tsme_course/data/gispd18o_raw.txt', na.strings = '999999')
colnames(gisp2) = c('Depth','d18o','Age')
with(gisp2,plot(Age,d18o,type='l'))
```

## Changes in variability & Heteroskedascticity
Monthly NH sea ice Anomaly from 1978 to present.

## Seasonal (and longer) cycles, periodicity

```{r plot ldeaths, echo=TRUE}
plot(ldeaths)
#with(ldeaths,plot(Age,d18o,type='l'))
```



## HADCET
Monthly Central England Temperature (CET) from 1659 

* Seasonality [on short term] & trend?

## Sea ice from 1953

* Trend, seasonality, heteroskedacity?, break points?





## Unpredictability and stochasticity

D18O? Global financial crash? Regime changes

## Autocorrelation and memory
- **Autocorrelation** is the correlation of a random process **with itself** at a different time.
- some created examples here

## Stationarity
 - In a **stationary** timeseries **mean**, **variance** and **autocorrelation** structure do not change over time.

## Differencing
- A timeseries of the differences between the values.
- Differencing can be used used to make a non-stationary trend stationary.

## Other important concepts

* Stationarity
* Lag
* Detrending and differencing
* Seasonality removal
* Smoothing & filtering
* Stochastic processes & Random walks

## What kind of analysis might we want to do?

## Understanding an underlying system

## Prediction of the system

## The limits of our analysis

This is the ```lynx``` data set, annual numbers of lynx trappings for Canada 1821 - 1934. Regarded as representative of the population.
```{r plot lynx, echo=TRUE}
plot(lynx)
```

## The limits of our analysis

- Reilly and Zeringue (2004) use a simple dynamic predator-prey model, trained on the first 80 years of data, to predict the last 34.
- The simple model outperforms many of the best time series methods.
<center><img src="~/GitHub/tsme_course/slides/graphics/lynx.png" width=40%/></center>
- RMS error of 1480, compared to 1600 for SETAR method fit with entire data set.
http://andrewgelman.com/2012/01/28/the-last-word-on-the-canadian-lynx-series/



